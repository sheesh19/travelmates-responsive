<div>
  <%= render "shared/components/button", variant: "filled", label: "+ Make a Travel Plan", href: new_itinerary_path %>
</div>

<!-- Search bar -->
<div class="search__box">
  <%= render 'shared/search/search_locations' %>
</div>

<!-- Displays search results dynamically -->
<% if @query %>
  <div>
    <h4>Search results</h4>
      <div class="card__grid">
        <% if @locations.any? %>
          <% @locations[0..@locations.count].each do |location| %>
      <div class="card map-card" style="width: 20rem;">
        <%= render "shared/mapstatic" %>
        <div class="card-body px-4 pb-4 pt-0">
          <h4 class="card-title">
            <i class="fas fa-map-marker-alt pr-1"></i>
            <%= location.city %>, <%= location.country %>
          </h4>
          <div id="map-card-info">
            <i class="fas fa-info-circle"></i>
              <!-- Number of events in this location coming up -->
              <%= Event.all.select{|e| e.location_id == location.id}.map.count %> travel mates going here
          </div>
        </div>
        <%= link_to "", location_path(location), class: "make-card-clickable" %>
      </div>
    <% end %>
  </div>
  <% else %>
    <div>
      <span>No results found</span>
    </div>
  <% end %>
  </div>
<% end %>

<div class="">
  <h4>Top 10 Locations</h4>
  <!-- Card Carousel -->
  <div class="card__grid">
    <% @all_locations.sort_by_events.each do |location| %>
      <div class="card map-card" style="width: 20rem;">
        <%= render "shared/mapstatic" %>
        <div class="card-body px-4 pb-4 pt-0">
          <h4 class="card-title">
            <i class="fas fa-map-marker-alt pr-1"></i>
            <%= location.city %>, <%= location.country %>
          </h4>
          <div id="map-card-info">
            <i class="fas fa-info-circle"></i>
              <!-- Number of events in this location coming up -->
              <%= Event.all.select{|e| e.location_id == location.id}.map.count %> travel mates going here
          </div>
        </div>
        <%= link_to "", location_path(location), class: "make-card-clickable" %>
      </div>
    <% end %>
  </div>
</div>

<div>
  <h4>Destination Discovery | FIX ME!</h4>
  <div class="events__upcoming">
    <div class="card__grid">
      <% @all_locations.each do |location| %>
        <div class="card map-card" style="width: 20rem;">
          <%= render "shared/mapstatic" %>
          <div class="card-body px-4 pb-4 pt-0">
            <h4 class="card-title">
              <i class="fas fa-map-marker-alt pr-1"></i>
              <%= location.city %>, <%= location.country %>
            </h4>
            <div id="map-card-info">
              <i class="fas fa-info-circle"></i>
                <!-- Number of events in this location coming up -->
                <%= Event.all.select{|e| e.location_id == location.id}.map.count %> travel mates going here
            </div>
          </div>
          <%= link_to "", location_path(location), class: "make-card-clickable" %>
        </div>
      <% end %>
    </div>
  </div>
</div>


